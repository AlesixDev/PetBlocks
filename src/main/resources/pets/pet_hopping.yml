# Unique template identifier
name: classic
# The version of this file.
# You can ignore this value, if it is not mentioned in the patchNotes.
version: 1.0
# The name of the pet shown above the pet. Supports ChatColors.
# Command /petblocks <name> displayName <value>
displayName: "%petblocks_owner_name%'s pet"
# Should the name of the pet be shown above the pet?
# Command /petblocks <name> isDisplayNameVisible <true/false>
isDisplayNameVisible: true
# Should the pet be shown to all players (e.g. "ALL") or shown to just the owner (e.g. "OWNER")?
# Command /petblocks <name> visibility <value>
visibility: "ALL"
# The initial loop state the pet starts with on first spawn.
# Command /petblocks loop <name> [player]
loop: "idle"
#
# Defines the action a pet should perform when a player rightclicks on it.
#
rightclick:
  actions:
    - name: "Open the deluxe menu" # Requires the DeluxeMenu plugin to be installed and configured to use the sample PetBlocks inventory.
      type: "command"
      level: "PLAYER"
      condition: '%petblocks_player_name% == %petblocks_owner_name%' # Checks if the player rightClicking the pet is the owner of the pet.
      run: |
        /petblocksmenu %petblocks_pet_name%
    - name: "Play effects when the owner rightclicks the pet"
      type: "command"
      level: "PLAYER"
      debug: "%petblocks_player_inventory_itemInMainHand_type%"
      condition: '%petblocks_player_name% == %petblocks_owner_name% && %petblocks_player_inventory_itemInMainHand_type% == "CARROT"'
      run: |
        /tell %petblocks_player_name% I love carrots <3
        /tell %petblocks_player_name% YES I LOVE THEM!

#
# Defines the action a pet should perform in an interval on its own.
#
loops:
  # You can add/remove new loops as you want here.
  # Give it a name like "idle2" and define the list of actions below.
  idle:
    actions:
      - name: "Delay Action"
        type: "DELAY"
        debug: true
        ticks: 20
      - name: "Look at owner with a 60% change."
        condition: "Math.floor(Math.random() * 100) > 40"
        debug: true
        type: "COMMAND"
        level: "SERVER"
        run:
          - "/petblocks lookatowner %petblocks_pet_name% %petblocks_owner_name%"
      - name: "Switch to moveToOwner if pet is too far away"
        condition: "%petblocks_pet_distanceToOwner% > 10"
        debug: true
        type: "COMMAND"
        level: "SERVER"
        run:
          - "/petblocks loop %petblocks_pet_name% moveToOwner %petblocks_owner_name%"
  moveToOwner:
    actions:
      - name: "Delay Action"
        type: "DELAY"
        debug: true
        ticks: 20
      - name: "Recalculate path and start moving to owner."
        type: "COMMAND"
        level: "SERVER"
        debug: true
        run:
          - "/petblocks moveToOwner %petblocks_pet_name% %petblocks_owner_name%"
      - name: "Switch to idle if the pet is beside the player"
        condition: "%petblocks_pet_distanceToOwner% < 4"
        type: "COMMAND"
        level: "SERVER"
        debug: true
        run:
          - "/petblocks loop %petblocks_pet_name% idle %petblocks_owner_name%"
      - name: "Teleport pet to player if the pet is too far away for the pathfinder."
        condition: "%petblocks_pet_distanceToOwner% > 20"
        type: "COMMAND"
        level: "SERVER"
        debug: true
        run:
          - "/petblocks teleport %petblocks_pet_name% %petblocks_owner_locationWorld% %petblocks_owner_locationX% %petblocks_owner_locationY% %petblocks_owner_locationZ% %petblocks_owner_locationYaw% %petblocks_owner_locationPitch% %petblocks_owner_name%"
