language: java
sudo: true
jdk:
  - oraclejdk8
cache:
  timeout: 1000
  directories:
  - $HOME/.m2/repository/org/spigotmc
  - $HOME/.m2/repository/org/mcp
before_install:
    - chmod +x gradlew
    - chmod +x petblocks-tools/travis-status.sh
    - sudo /etc/init.d/mysql stop
    - echo $GPG_SECRET_KEYS | base64 --decode | $GPG_EXECUTABLE --import
    - echo $GPG_OWNERTRUST | base64 --decode | $GPG_EXECUTABLE --import-ownertrust
    - if [[ $TRAVIS_COMMIT_MESSAGE == *"--refresh-dependencies"* ]]; then ./gradlew downloadDependencies; fi ;
script:
  - ./gradlew clean build
after_success:
  - ./gradlew jacocoTestReport
  - bash <(curl -s https://codecov.io/bash)
  - if [[ $TRAVIS_COMMIT_MESSAGE == *"--snapshot"* ]]; then java -jar petblocks-tools/Deploy.jar --snapshot $WEBHOOK_URL; fi ;
  - ./petblocks-tools/travis-status.sh success $WEBHOOK_URL
after_failure:
  - ./petblocks-tools/travis-status.sh failure $WEBHOOK_URL

  #- mvn clean deploy --settings .travis_settings.xml
#after_success:
#  - bash <(curl -s https://codecov.io/bash)
#  - wget https://github.com/Shynixn/travis-ci-discord-webhook/raw/master/nexus-query-snapshot.jar
#  - wget https://raw.githubusercontent.com/Shynixn/travis-ci-discord-webhook/master/petblocks.sh
 # - chmod +x petblocks.sh
 # - ./petblocks.sh success $WEBHOOK_URL $WEBHOOK_SNAPSHOT_URL $SNAPSHOT_REPOSITORY_BUKKIT $SNAPSHOT_REPOSITORY_SPONGE
#after_failure:
#  - wget https://raw.githubusercontent.com/Shynixn/travis-ci-discord-webhook/master/send.sh
#  - chmod +x send.sh
 # - ./send.sh failure $WEBHOOK_URL